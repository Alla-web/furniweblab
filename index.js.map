{"version":3,"file":"index.js","sources":["../src/js/furniture-list.js","../src/js/order-modal.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\naxios.defaults.baseURL = 'https://furniture-store-v2.b.goit.study/api';\n\nasync function fetchCategories() {\n  try {\n    const { data: categories } = await axios('/categories');\n    return categories;\n  } catch (error) {\n    iziToast.error({\n      message: `${error.message ?? String(error)}`,\n      position: 'topCenter',\n      timeout: 3000,\n      backgroundColor: '#EF4040',\n      messageColor: 'white',\n      close: false,\n    });\n  }\n}\n\n//отримуємо список категорій\nfetchCategories();\n\nconst categoriesBoxes = document.querySelectorAll('.category-card');\n\nasync function renderCategories(categoriesBoxes) {\n  const categories = await fetchCategories();\n\n  [...categoriesBoxes].forEach((categoryBox, index) => {\n    if (index === 0) {\n      return;\n    }\n\n    categoryBox.dataset.id = categories[index - 1]._id;\n    categoryBox.children[0].textContent = categories[index - 1].name;\n  });\n}\n\n//промальовуємо назви категорій\nrenderCategories(categoriesBoxes);\n\n//ловимо клік по категорії\nconst furnitureListContainer = document.querySelector('.futniture-list');\nconst categoryContainer = document.querySelector('.category-container');\n\ncategoryContainer.addEventListener('click', onCategoryClick);\n\nasync function onCategoryClick(event) {\n  event.preventDefault();\n\n  const pickedCategoryCard = event.target.closest('.category-card');\n\n  if (!categoryContainer.contains(pickedCategoryCard) || !pickedCategoryCard) {\n    return;\n  }\n\n  const categoryId = pickedCategoryCard.dataset.id;\n  let itemsPage = 1;\n\n  try {\n    const { data: categoryItems } = await axios(`/furnitures`, {\n      params: {\n        page: itemsPage,\n        limit: 10,\n        category: categoryId,\n        // sortDirect: asc,\n      },\n    });\n\n    furnitureListContainer.innerHTML = renderFurnitureList(\n      categoryItems.furnitures\n    );\n  } catch (error) {\n    iziToast.error({\n      message: `${error.message ?? String(error)}`,\n      position: 'topCenter',\n      timeout: 3000,\n      backgroundColor: '#EF4040',\n      messageColor: 'white',\n      close: false,\n    });\n  }\n}\n\nfunction renderFurnitureList(furnitureList) {\n  return furnitureList\n    .map(\n      furniItem => `\n        <li data-id=\"${furniItem._id}\">\n            <img class=\"\" src=\"${furniItem.images[0]}\" alt=\"${furniItem.name}\"/>\n            <h3 class=\"\">${furniItem.name}</h3>\n            <ul class=\"\">\n                <li class=\"\" style=\"background-color: ${\n                  furniItem.color[0]\n                }; color: transparent;\">1</li>\n                <li class=\"\" style=\"background-color: ${\n                  furniItem.color[1]\n                }; color: transparent;\">1</li>\n                <li class=\"\" style=\"cobackground-color: ${\n                  furniItem.color[2]\n                }; color: transparent;\">1</li>\n            </ul>\n            <p class=\"\">${furniItem.price.toLocaleString()} грн</p>\n            <button class=\"button load-more-furni-button\">Детальніше</button>\n        </li>\n    `\n    )\n    .join('');\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst modal = document.getElementById(\"order-modal\");\nconst closeModalBtn = document.getElementById(\"closeModalBtn\");\nconst form = document.getElementById(\"callback-form\");\nlet productId = null;\nlet color = null;\n\ndocument.addEventListener(\"click\", (e) => {\n  const btn = e.target.closest(\".open-order-modal-btn\");\n  if (!btn) return;\n\n\n  productId = btn.dataset.productId;\n  color = btn.dataset.color;\n\n  modal.style.display = \"flex\";\n  document.body.style.overflow = \"hidden\";\n});\n\nfunction closeModal() {\n  modal.style.display = \"none\";\n  document.body.style.overflow = \"\";\n  form.reset();\n  clearErrors();\n}\n\ncloseModalBtn.addEventListener(\"click\", closeModal);\nmodal.addEventListener(\"click\", (e) => {\n  if (e.target === modal) closeModal();\n});\ndocument.addEventListener(\"keydown\", (e) => {\n  if (e.key === \"Escape\" && modal.style.display === \"flex\") closeModal();\n});\n\nfunction showInputError(input, message) {\n  input.style.border = \"1px solid #6b0609\";\n\n  let errorEl = input.parentNode.querySelector(\".input-error-text\");\n  if (!errorEl) {\n    errorEl = document.createElement(\"p\");\n    errorEl.classList.add(\"input-error-text\");\n    input.parentNode.appendChild(errorEl);\n  }\n  errorEl.textContent = message;\n}\n\nfunction clearErrors() {\n  document.querySelectorAll(\".input-error-text\").forEach((e) => e.remove());\n  form.querySelectorAll(\"input, textarea\").forEach((el) => {\n    el.style.border = \"1px solid rgba(8, 12, 9, 0.15)\";\n  });\n}\n\nform.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n  clearErrors();\n\n  const name = form.name.value.trim();\n  let phone = form.phone.value.trim();\n  const comment = form.comment.value.trim();\n\n  let hasError = false;\n\n  if (!name) {\n    showInputError(form.name, \"Error Text\");\n    hasError = true;\n  }\n\n  if (!phone || !/^\\d+$/.test(phone)) {\n    showInputError(form.phone, \"Error Text\");\n    hasError = true;\n  }\n\n  if (hasError) return;\n\n  if (phone.startsWith(\"0\")) phone = \"38\" + phone;\n\n  const orderData = {\n    name,\n    phone,\n    modelId: productId,\n    color,\n    comment: comment || \"Чекатиму на зворотний зв'язок для уточнення деталей. Дякую!\",\n  };\n\n  try {\n    const response = await fetch(\n      \"https://furniture-store-v2.b.goit.study/api/orders\",\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(orderData),\n      }\n    );\n\n    const result = await response.json();\n    console.log(\"Відповідь від сервера:\", result);\n\n    if (!response.ok) {\n      iziToast.error({\n        title: \"Помилка!\",\n        message: result.message || \"Щось пішло не так. Перевірте дані.\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    iziToast.success({\n      title: \"Успіх!\",\n      message: `Замовлення №${result.orderNum} успішно створено!`,\n      position: \"topRight\",\n    });\n\n    closeModal();\n  } catch (err) {\n    console.error(\"Помилка при запиті:\", err);\n    iziToast.error({\n      title: \"Помилка!\",\n      message: \"Не вдалося відправити замовлення. Спробуйте пізніше.\",\n      position: \"topRight\",\n    });\n  }\n});\n"],"names":["axios","fetchCategories","categories","error","iziToast","categoriesBoxes","renderCategories","categoryBox","index","furnitureListContainer","categoryContainer","onCategoryClick","event","pickedCategoryCard","categoryId","itemsPage","categoryItems","renderFurnitureList","furnitureList","furniItem","modal","closeModalBtn","form","productId","color","btn","closeModal","clearErrors","showInputError","input","message","errorEl","el","name","phone","comment","hasError","orderData","response","result","err"],"mappings":"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"}