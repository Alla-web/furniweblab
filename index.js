import{a as d,i}from"./assets/vendor-DbEaHZRp.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const u=document.getElementById("burger"),v=document.getElementById("nav"),m=document.getElementById("overlay");u.addEventListener("click",()=>{const e=v.classList.toggle("active");m.classList.toggle("active"),u.classList.toggle("active",e)});m.addEventListener("click",()=>{v.classList.remove("active"),m.classList.remove("active"),u.classList.remove("active")});document.querySelectorAll(".nav__link, .nav__btn").forEach(e=>{e.addEventListener("click",()=>{v.classList.remove("active"),m.classList.remove("active"),u.classList.remove("active")})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".btn.btn-link"),t="feedbacks";e.addEventListener("click",o=>{o.preventDefault();const n=document.getElementById(t);n&&n.scrollIntoView({behavior:"smooth",block:"start"})})});d.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";async function h(){try{const{data:e}=await d("/categories");return e}catch(e){i.error({message:`${e.message??String(e)}`,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}}h();const q=document.querySelectorAll(".category-card");async function O(e){const t=await h();[...e].forEach((o,n)=>{n!==0&&(o.dataset.id=t[n-1]._id,o.children[0].textContent=t[n-1].name)})}O(q);const T=document.querySelector(".futniture-list"),L=document.querySelector(".category-container");L.addEventListener("click",x);async function x(e){e.preventDefault();const t=e.target.closest(".category-card");if(!L.contains(t)||!t)return;const o=t.dataset.id;let n=1;try{const{data:r}=await d("/furnitures",{params:{page:n,limit:10,category:o}});T.innerHTML=M(r.furnitures)}catch(r){i.error({message:`${r.message??String(r)}`,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}}function M(e){return e.sort((t,o)=>t.price-o.price).map(t=>`
        <li>
            <img class="card-image" src="${t.images[0]}" alt="${t.name}"/>
            <h3 class="card-title">${t.name}</h3>
            <ul class="card-color-container">
                ${(t.color||[]).map(o=>`
                    <li
                    class="card-color-item"
                    style="background-color: ${o};">1
                    </li>
                    `).join("")}               
            </ul>
            <p class="card-price">${t.price.toLocaleString()} грн</p>
            <button 
                class="details-button button" 
                data-id="${t._id}">Детальніше</button>
        </li>
    `).join("")}d.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";function E(e){i.error({message:e,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}async function B(e){try{return(await d.get(`/products/${e}`)).data}catch(t){throw console.error(`Помилка при отриманні деталей продукту з ID ${e}:`,t),t}}const p=document.querySelector(".product-modal-backdrop"),$=document.querySelector(".product-modal .modal-main-content"),A=document.querySelector(".modal-close-btn"),C=document.body;function _(e){return`<rating data-rating="${e}" data-max-rating="5" data-icon="&#9733;" data-font-size="20px" class="rating-stars"></rating>`}function D(e){return`<div class="color-options-container"><p class="color-label">Колір</p><form class="color-options">${e.map((o,n)=>{const r=`color-${o.substring(1)}`;return`
            <label class="color-option">
                <input type="radio" name="product-color" value="${o}" id="${r}" ${n===0?"checked":""} class="visually-hidden">
                <span class="custom-radio-style ${n===0?"is-active":""}" style="background-color: ${o};" data-color-hex="${o}"></span>
            </label>
        `}).join("")}</form></div>`}function P(e){const t=e.price.toLocaleString()+" грн";return`
        <div class="product-gallery">
            <img src="${e.images[0]}" alt="${e.name} (Основне)" class="main-product-image">
            <div class="gallery-thumbnails">
                 ${e.images.slice(1).map(o=>`<img src="${o}" alt="${e.name} (Мініатюра)" class="gallery-thumbnail">`).join("")}
            </div>
        </div>
        
        <div class="product-info">
            <h2 class="model-name">${e.name}</h2> <p class="category-name">${e.category.name}</p> <p class="product-price"><span class="price-value">${t}</span><span class="price-currency"></span></p> ${_(e.rate)} ${D(e.color)} <div class="product-details">
                <p class="description-text">${e.description}</p> <p class="dimensions-text">Розміри: ${e.sizes} см</p> </div>
            
            <button 
                class="button order-btn open-order-modal-btn" 
                type="button"
                data-product-id="${e._id}"      
                data-marker="details_page_order">  
                Перейти до замовлення
            </button>
        </div>
    `}function F(e){e.currentTarget.querySelectorAll(".custom-radio-style").forEach(o=>o.classList.remove("is-active")),e.target.classList.contains("visually-hidden")&&e.target.nextElementSibling.classList.add("is-active")}function g(){p.classList.add("is-hidden"),C.classList.remove("modal-open"),document.removeEventListener("keydown",k),$.innerHTML=""}async function N(e){const t=e.detail.productId;try{const o=await B(t);$.innerHTML=P(o);const n=document.querySelector(".product-modal .color-options");n&&n.addEventListener("change",F),document.querySelector(".product-modal .open-order-modal-btn").addEventListener("click",j),p.classList.remove("is-hidden"),C.classList.add("modal-open"),document.addEventListener("keydown",k)}catch{E("Не вдалося відобразити деталі товару.")}}function j(e){const t=e.currentTarget.dataset.productId,o=e.currentTarget.dataset.marker,n=document.querySelector(".color-options input:checked"),r=n?n.value:null;if(!t||!r){E("Необхідно обрати колір перед замовленням.");return}g();const s=new CustomEvent("open-order-modal",{bubbles:!0,detail:{productId:t,selectedColor:r,markerValue:o}});document.body.dispatchEvent(s)}function k(e){e.key==="Escape"&&g()}p.addEventListener("click",e=>{e.target===p&&g()});A.addEventListener("click",g);document.body.addEventListener("open-details-modal",N);const l=document.getElementById("order-modal"),R=document.getElementById("closeModalBtn"),a=document.getElementById("callback-form");let S=null,w=null;document.addEventListener("click",e=>{const t=e.target.closest(".open-order-modal-btn");t&&(S=t.dataset.productId,w=t.dataset.color,l.style.display="flex",document.body.style.overflow="hidden")});function y(){l.style.display="none",document.body.style.overflow="",a.reset(),I()}R.addEventListener("click",y);l.addEventListener("click",e=>{e.target===l&&y()});document.addEventListener("keydown",e=>{e.key==="Escape"&&l.style.display==="flex"&&y()});function b(e,t){e.style.border="1px solid #6b0609";let o=e.parentNode.querySelector(".input-error-text");o||(o=document.createElement("p"),o.classList.add("input-error-text"),e.parentNode.appendChild(o)),o.textContent=t}function I(){document.querySelectorAll(".input-error-text").forEach(e=>e.remove()),a.querySelectorAll("input, textarea").forEach(e=>{e.style.border="1px solid rgba(8, 12, 9, 0.15)"})}a.addEventListener("submit",async e=>{e.preventDefault(),I();const t=a.name.value.trim();let o=a.phone.value.trim();const n=a.comment.value.trim();let r=!1;if(t||(b(a.name,"Error Text"),r=!0),(!o||!/^\d+$/.test(o))&&(b(a.phone,"Error Text"),r=!0),r)return;o.startsWith("0")&&(o="38"+o);const s={name:t,phone:o,modelId:S,color:w,comment:n||"Чекатиму на зворотний зв'язок для уточнення деталей. Дякую!"};try{const c=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),f=await c.json();if(console.log("Відповідь від сервера:",f),!c.ok){i.error({title:"Помилка!",message:f.message||"Щось пішло не так. Перевірте дані.",position:"topRight"});return}i.success({title:"Успіх!",message:`Замовлення №${f.orderNum} успішно створено!`,position:"topRight"}),y()}catch(c){console.error("Помилка при запиті:",c),i.error({title:"Помилка!",message:"Не вдалося відправити замовлення. Спробуйте пізніше.",position:"topRight"})}});
//# sourceMappingURL=index.js.map
