import{a as m,i}from"./assets/vendor-CLTxG5yw.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();m.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";async function f(){try{const{data:e}=await m("/categories");return e}catch(e){i.error({message:`${e.message??String(e)}`,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}}f();const E=document.querySelectorAll(".category-card");async function C(e){const t=await f();[...e].forEach((o,n)=>{n!==0&&(o.dataset.id=t[n-1]._id,o.children[0].textContent=t[n-1].name)})}C(E);const v=document.querySelector(".futniture-list"),g=document.querySelector(".category-container");g.addEventListener("click",L);async function L(e){e.preventDefault();const t=e.target.closest(".category-card");if(!g.contains(t)||!t)return;const o=t.dataset.id;let n=1;try{const{data:r}=await m("/furnitures",{params:{page:n,limit:10,category:o}});v.innerHTML=w(r.furnitures)}catch(r){i.error({message:`${r.message??String(r)}`,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}}function w(e){return e.map(t=>`
        <li data-id="${t._id}">
            <img class="" src="${t.images[0]}" alt="${t.name}"/>
            <h3 class="">${t.name}</h3>
            <ul class="">
                <li class="" style="background-color: ${t.color[0]}; color: transparent;">1</li>
                <li class="" style="background-color: ${t.color[1]}; color: transparent;">1</li>
                <li class="" style="cobackground-color: ${t.color[2]}; color: transparent;">1</li>
            </ul>
            <p class="">${t.price.toLocaleString()} грн</p>
            <button class="button load-more-furni-button">Детальніше</button>
        </li>
    `).join("")}const l=document.getElementById("order-modal"),S=document.getElementById("closeModalBtn"),c=document.getElementById("callback-form");let y=null,h=null;document.addEventListener("click",e=>{const t=e.target.closest(".open-order-modal-btn");t&&(y=t.dataset.productId,h=t.dataset.color,l.style.display="flex",document.body.style.overflow="hidden")});function d(){l.style.display="none",document.body.style.overflow="",c.reset(),b()}S.addEventListener("click",d);l.addEventListener("click",e=>{e.target===l&&d()});document.addEventListener("keydown",e=>{e.key==="Escape"&&l.style.display==="flex"&&d()});function p(e,t){e.style.border="1px solid #6b0609";let o=e.parentNode.querySelector(".input-error-text");o||(o=document.createElement("p"),o.classList.add("input-error-text"),e.parentNode.appendChild(o)),o.textContent=t}function b(){document.querySelectorAll(".input-error-text").forEach(e=>e.remove()),c.querySelectorAll("input, textarea").forEach(e=>{e.style.border="1px solid rgba(8, 12, 9, 0.15)"})}c.addEventListener("submit",async e=>{e.preventDefault(),b();const t=c.name.value.trim();let o=c.phone.value.trim();const n=c.comment.value.trim();let r=!1;if(t||(p(c.name,"Error Text"),r=!0),(!o||!/^\d+$/.test(o))&&(p(c.phone,"Error Text"),r=!0),r)return;o.startsWith("0")&&(o="38"+o);const s={name:t,phone:o,modelId:y,color:h,comment:n||"Чекатиму на зворотний зв'язок для уточнення деталей. Дякую!"};try{const a=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),u=await a.json();if(console.log("Відповідь від сервера:",u),!a.ok){i.error({title:"Помилка!",message:u.message||"Щось пішло не так. Перевірте дані.",position:"topRight"});return}i.success({title:"Успіх!",message:`Замовлення №${u.orderNum} успішно створено!`,position:"topRight"}),d()}catch(a){console.error("Помилка при запиті:",a),i.error({title:"Помилка!",message:"Не вдалося відправити замовлення. Спробуйте пізніше.",position:"topRight"})}});
//# sourceMappingURL=index.js.map
