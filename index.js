import{a as u,i as d,A as H}from"./assets/vendor-DNuq5G_u.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const y=document.getElementById("burger"),$=document.getElementById("nav"),v=document.getElementById("overlay");y.addEventListener("click",()=>{const e=$.classList.toggle("active");v.classList.toggle("active"),y.classList.toggle("active",e)});v.addEventListener("click",()=>{$.classList.remove("active"),v.classList.remove("active"),y.classList.remove("active")});document.querySelectorAll(".nav__link, .nav__btn").forEach(e=>{e.addEventListener("click",()=>{$.classList.remove("active"),v.classList.remove("active"),y.classList.remove("active")})});document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".btn.btn-link"),o="feedbacks";e.addEventListener("click",t=>{t.preventDefault();const r=document.getElementById(o);r&&r.scrollIntoView({behavior:"smooth",block:"start"})})});u.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";const h="pickedCategoryId";function S(e){d.error({message:`${e.message??String(e)}`,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}function w(e){d.info({message:`${e}`,position:"topCenter",timeout:3e3,backgroundColor:"#009b18",messageColor:"white",close:!1})}const I=document.querySelector(".loading");function A(){I.hidden=!1}function B(){I.hidden=!0}localStorage.removeItem(h);let c=1,m=0,p=0;const g=8;async function O(){try{const{data:e}=await u("/categories");return e}catch(e){S(e)}}O();const z=document.querySelectorAll(".category-card");async function J(e){const o=await O();[...e].forEach((t,r)=>{r!==0&&(t.dataset.id=o[r-1]._id,t.children[0].textContent=o[r-1].name)})}J(z);const l=document.querySelector(".futniture-list"),T=document.querySelector(".category-container");T.addEventListener("click",K);async function K(e){A();const o=e.target.closest(".category-card");if(!T.contains(o)||!o)return;c=1,l.innerHTML="";const t=o.dataset.id;t==null?localStorage.removeItem(h):localStorage.setItem(h,JSON.stringify(t));try{const{data:r}=await u("/furnitures",{params:{page:c,limit:g,category:t}});m=r.totalItems,p=Math.ceil(m/g),c=r.page,console.log("totalItems: ",m),console.log("limit: ",g),console.log("totalPages: ",p),console.log("itemsPage: ",c),l.innerHTML=x(r.furnitures),b.hidden=c>=p,B()}catch(r){S(r)}}function x(e){return e.sort((o,t)=>o.price-t.price).map(o=>`
        <li class="furniture-list-item">
            <img class="card-image" src="${o.images[0]}" alt="${o.name}"/>
            <h3 class="card-title">${o.name}</h3>
            <ul class="card-color-container">
                ${(o.color||[]).map(t=>`
                    <li
                    class="card-color-item"
                    style="background-color: ${t};">1
                    </li>
                    `).join("")}               
            </ul>
            <p class="card-price">${o.price.toLocaleString()} грн</p>
            <button 
                class="details-button button" 
                data-id="${o._id}">Детальніше</button>
        </li>
    `).join("")}const b=document.querySelector(".load-more-button");b.addEventListener("click",V);async function V(e){if(l.insertAdjacentElement("beforeend",I),A(),!l.children.length){w("Please, pick the furnirure category before");return}c++;const o=JSON.parse(localStorage.getItem(h));try{const{data:t}=await u("/furnitures",{params:{page:c,limit:g,category:o}});m=t.totalItems,p=Math.ceil(m/g),c=Number(t.page),c<p?(l.insertAdjacentHTML("beforeend",x(t.furnitures)),b.hidden=!1):(w("This categoty has not more furniture"),b.hidden=!0);const r=l.querySelector(".furniture-list-item");r&&window.scrollBy({left:0,top:r.getBoundingClientRect().height,behavior:"smooth"}),B()}catch(t){S(t)}finally{console.log("Count of cards: ",l.children.length)}}new H(".qa",{duration:300,showMultiple:!1,openOnInit:[]});const q=document.querySelectorAll(".faq-quest");q.forEach(e=>{e.addEventListener("click",()=>{const o=e.getAttribute("aria-expanded")==="true";q.forEach(t=>t.setAttribute("aria-expanded","false")),o||e.setAttribute("aria-expanded","true")})});u.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";function P(e){d.error({message:e,position:"topCenter",timeout:3e3,backgroundColor:"#EF4040",messageColor:"white",close:!1})}async function G(e){try{return(await u.get(`/products/${e}`)).data}catch(o){throw console.error(`Помилка при отриманні деталей продукту з ID ${e}:`,o),o}}const E=document.querySelector(".product-modal-backdrop"),N=document.querySelector(".product-modal .modal-main-content"),U=document.querySelector(".modal-close-btn"),_=document.body;function W(e){return`<rating data-rating="${e}" data-max-rating="5" data-icon="&#9733;" data-font-size="20px" class="rating-stars"></rating>`}function Y(e){return`<div class="color-options-container"><p class="color-label">Колір</p><form class="color-options">${e.map((t,r)=>{const n=`color-${t.substring(1)}`;return`
            <label class="color-option">
                <input type="radio" name="product-color" value="${t}" id="${n}" ${r===0?"checked":""} class="visually-hidden">
                <span class="custom-radio-style ${r===0?"is-active":""}" style="background-color: ${t};" data-color-hex="${t}"></span>
            </label>
        `}).join("")}</form></div>`}function Q(e){const o=e.price.toLocaleString()+" грн";return`
        <div class="product-gallery">
            <img src="${e.images[0]}" alt="${e.name} (Основне)" class="main-product-image">
            <div class="gallery-thumbnails">
                 ${e.images.slice(1).map(t=>`<img src="${t}" alt="${e.name} (Мініатюра)" class="gallery-thumbnail">`).join("")}
            </div>
        </div>
        
        <div class="product-info">
            <h2 class="model-name">${e.name}</h2> <p class="category-name">${e.category.name}</p> <p class="product-price"><span class="price-value">${o}</span><span class="price-currency"></span></p> ${W(e.rate)} ${Y(e.color)} <div class="product-details">
                <p class="description-text">${e.description}</p> <p class="dimensions-text">Розміри: ${e.sizes} см</p> </div>
            
            <button 
                class="button order-btn open-order-modal-btn" 
                type="button"
                data-product-id="${e._id}"      
                data-marker="details_page_order">  
                Перейти до замовлення
            </button>
        </div>
    `}function X(e){e.currentTarget.querySelectorAll(".custom-radio-style").forEach(t=>t.classList.remove("is-active")),e.target.classList.contains("visually-hidden")&&e.target.nextElementSibling.classList.add("is-active")}function L(){E.classList.add("is-hidden"),_.classList.remove("modal-open"),document.removeEventListener("keydown",D),N.innerHTML=""}async function Z(e){const o=e.detail.productId;try{const t=await G(o);N.innerHTML=Q(t);const r=document.querySelector(".product-modal .color-options");r&&r.addEventListener("change",X),document.querySelector(".product-modal .open-order-modal-btn").addEventListener("click",ee),E.classList.remove("is-hidden"),_.classList.add("modal-open"),document.addEventListener("keydown",D)}catch{P("Не вдалося відобразити деталі товару.")}}function ee(e){const o=e.currentTarget.dataset.productId,t=e.currentTarget.dataset.marker,r=document.querySelector(".color-options input:checked"),n=r?r.value:null;if(!o||!n){P("Необхідно обрати колір перед замовленням.");return}L();const s=new CustomEvent("open-order-modal",{bubbles:!0,detail:{productId:o,selectedColor:n,markerValue:t}});document.body.dispatchEvent(s)}function D(e){e.key==="Escape"&&L()}E.addEventListener("click",e=>{e.target===E&&L()});U.addEventListener("click",L);document.body.addEventListener("open-details-modal",Z);function te(e){const o=e.target.closest(".details-button");if(!o||!o.dataset.id)return;e.preventDefault();const t=o.dataset.id,r=new CustomEvent("open-details-modal",{bubbles:!0,detail:{productId:t}});document.body.dispatchEvent(r)}document.body.addEventListener("click",te);const f=document.getElementById("order-modal"),oe=document.getElementById("closeModalBtn"),i=document.getElementById("callback-form");let j=null,F=null;document.addEventListener("click",e=>{const o=e.target.closest(".open-order-modal-btn");o&&(j=o.dataset.productId,F=o.dataset.color,f.style.display="flex",document.body.style.overflow="hidden")});function k(){f.style.display="none",document.body.style.overflow="",i.reset(),R()}oe.addEventListener("click",k);f.addEventListener("click",e=>{e.target===f&&k()});document.addEventListener("keydown",e=>{e.key==="Escape"&&f.style.display==="flex"&&k()});function M(e,o){e.style.border="1px solid #6b0609";let t=e.parentNode.querySelector(".input-error-text");t||(t=document.createElement("p"),t.classList.add("input-error-text"),e.parentNode.appendChild(t)),t.textContent=o}function R(){document.querySelectorAll(".input-error-text").forEach(e=>e.remove()),i.querySelectorAll("input, textarea").forEach(e=>{e.style.border="1px solid rgba(8, 12, 9, 0.15)"})}i.addEventListener("submit",async e=>{e.preventDefault(),R();const o=i.name.value.trim();let t=i.phone.value.trim();const r=i.comment.value.trim();let n=!1;if(o||(M(i.name,"Error Text"),n=!0),(!t||!/^\d+$/.test(t))&&(M(i.phone,"Error Text"),n=!0),n)return;t.startsWith("0")&&(t="38"+t);const s={name:o,phone:t,modelId:j,color:F,comment:r||"Чекатиму на зворотний зв'язок для уточнення деталей. Дякую!"};try{const a=await fetch("https://furniture-store-v2.b.goit.study/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),C=await a.json();if(console.log("Відповідь від сервера:",C),!a.ok){d.error({title:"Помилка!",message:C.message||"Щось пішло не так. Перевірте дані.",position:"topRight"});return}d.success({title:"Успіх!",message:`Замовлення №${C.orderNum} успішно створено!`,position:"topRight"}),k()}catch(a){console.error("Помилка при запиті:",a),d.error({title:"Помилка!",message:"Не вдалося відправити замовлення. Спробуйте пізніше.",position:"topRight"})}});
//# sourceMappingURL=index.js.map
